<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CHARIS MODEL ACADEMY - Portal</title>
<style>
:root {
  --wine: #722f37;
  --cream: #f8f5e9;
  --gold: #c9a646;
  --white: #ffffff;
}
body {
  margin: 0;
  font-family: "Segoe UI", sans-serif;
  background: var(--cream);
  color: var(--wine);
}
header {
  background: var(--wine);
  color: var(--gold);
  padding: 20px;
  text-align: center;
  font-size: 1.6em;
  font-weight: bold;
  box-shadow: 0 4px 6px rgba(0,0,0,0.2);
}
.container {
  width: 90%;
  max-width: 700px;
  background: var(--white);
  margin: 40px auto;
  padding: 25px;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
}
.hidden { display: none; }
label {
  display: block;
  margin: 12px 0 5px;
  font-weight: bold;
}
input, select, button {
  width: 100%;
  padding: 12px;
  margin-bottom: 15px;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 1em;
}
button {
  background: var(--wine);
  color: var(--white);
  border: none;
  font-weight: bold;
  cursor: pointer;
}
button:hover {
  background: var(--gold);
  color: var(--wine);
}
h2, h3, h4 { text-align: center; margin-top: 0; }
.report-card {
  background: var(--white);
  border: 2px solid var(--gold);
  border-radius: 10px;
  padding: 20px;
  max-width: 800px;
  margin: auto;
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
}
.report-card table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}
.report-card th, .report-card td {
  border: 1px solid var(--gold);
  padding: 8px;
  text-align: center;
}
.report-card th {
  background: var(--wine);
  color: var(--white);
}
.footer-info {
  margin-top: 15px;
  padding: 10px;
  background: var(--cream);
  border-radius: 8px;
  font-weight: bold;
}
.signatures {
  margin-top: 25px;
  display: flex;
  justify-content: space-between;
  padding: 0 40px;
}
.signature-block {
  text-align: center;
}
.signature-line {
  border-top: 1px solid #000;
  width: 200px;
  margin: 40px auto 5px;
}
.print-btn, .logout-btn {
  display: block;
  margin: 15px auto;
  padding: 10px 18px;
  border: none;
  border-radius: 8px;
  background: var(--wine);
  color: var(--white);
  font-size: 1em;
  font-weight: 600;
  cursor: pointer;
}
.print-btn:hover, .logout-btn:hover {
  background: var(--gold);
  color: var(--wine);
}
@media print {
  header, .print-btn, .logout-btn, footer { display: none; }
  body { background: #fff; }
  .report-card { box-shadow: none; border: 1px solid #000; }
}
footer {
  text-align: center;
  padding: 15px;
  background: var(--wine);
  color: var(--gold);
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
}
</style>
</head>
<body>
<header>CHARIS MODEL ACADEMY - Portal</header>

<!-- LOGIN -->
<div class="container" id="loginPage">
  <h2>Login</h2>
  <label for="role">Select Role:</label>
  <select id="role">
    <option value="student">Student</option>
    <option value="teacher">Teacher</option>
    <option value="admin">Admin</option>
  </select>
  <label for="idInput">Enter ID:</label>
  <input type="text" id="idInput" placeholder="Enter ID">
  <button onclick="login()">Login</button>
</div>

<!-- STUDENT DASHBOARD -->
<div class="container hidden" id="studentPage">
  <h2>Student Dashboard</h2>
  <div id="studentContent"></div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<!-- TEACHER DASHBOARD -->
<div class="container hidden" id="teacherPage">
  <h2>Teacher Dashboard</h2>
  <label for="levelSelect">Select Level:</label>
  <select id="levelSelect"></select>
  <label for="studentSelect">Select Student:</label>
  <select id="studentSelect"></select>
  <label for="nameInput">Student Full Name:</label>
  <input type="text" id="nameInput" placeholder="Enter Full Name">
  <label for="subjectSelect">Select Subject:</label>
  <select id="subjectSelect"></select>
  <label for="scoreInput">Enter Score (0-100):</label>
  <input type="number" id="scoreInput">
  <button onclick="saveGrade()">Save Grade</button>
  <div id="teacherMsg"></div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<!-- ADMIN DASHBOARD -->
<div class="container hidden" id="adminPage">
  <h2>Admin Dashboard</h2>
  <h3>Manage Teachers</h3>
  <label for="newTeacherId">Add Teacher ID:</label>
  <input type="text" id="newTeacherId" placeholder="CMA-TE001">
  <button onclick="addTeacher()">Add Teacher</button>
  <label for="removeTeacherId">Remove Teacher ID:</label>
  <input type="text" id="removeTeacherId" placeholder="CMA-TE001">
  <button onclick="removeTeacher()">Remove Teacher</button>
  <h3>All Teachers</h3>
  <ul id="teacherList"></ul>
  <h3>Modify Student Results</h3>
  <label for="adminLevelSelect">Select Level:</label>
  <select id="adminLevelSelect"></select>
  <label for="adminStudentSelect">Select Student:</label>
  <select id="adminStudentSelect"></select>
  <label for="adminNameInput">Student Full Name:</label>
  <input type="text" id="adminNameInput" placeholder="Enter Full Name">
  <label for="adminSubjectSelect">Select Subject:</label>
  <select id="adminSubjectSelect"></select>
  <label for="adminScoreInput">Enter Score (0-100):</label>
  <input type="number" id="adminScoreInput">
  <button onclick="adminUpdateGrade()">Update Result</button>
  <div id="adminMsg"></div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<footer>Charis Model Academy ¬© 2025</footer>

<script>
/* SUBJECTS & LEVELS */
const subjects={core:["English Language","Social Studies","Integrated Science","Mathematics"],
elective:["Career Technology","Creative Arts and Design","French Language","Ghanaian Language (Ga, Dangme, Twi, Fante, Nzema, Ewe, etc)","Computing","History"]};
const allSubjects=[...subjects.core,...subjects.elective];
const levels=["B1","B2","B3","B4","B5","B6","JHS1","JHS2","JHS3"];
let data={students:{},teachers:["CMA-TE001"],admins:["CMA-ADMIN001"]};

/* Initialize Students */
levels.forEach(lvl=>{
  data.students[lvl]=[];
  for(let i=1;i<=50;i++){
    let g={}; allSubjects.forEach(s=>g[s]={score:null,grade:"",remark:""});
    data.students[lvl].push({id:`CMA/STU/${lvl}/${i.toString().padStart(3,"0")}`,name:`Student ${i}`,level:lvl,grades:g});
  }
});

/* GRADE REMARK FUNCTION */
function getGradeRemark(score){
  if(score>=80) return {grade:"A",remark:"Excellent"};
  if(score>=70) return {grade:"B",remark:"Very Good"};
  if(score>=60) return {grade:"C",remark:"Good"};
  if(score>=50) return {grade:"D",remark:"Pass"};
  if(score>=40) return {grade:"E",remark:"Pass"};
  return {grade:"F",remark:"Fail"};
}

let currentUser=null;

/* LOGIN */
function login(){
  let role=document.getElementById("role").value;
  let id=document.getElementById("idInput").value.trim().toUpperCase();
  if(role==="student"){
    for(let lvl of levels){
      let stu=data.students[lvl].find(s=>s.id===id);
      if(stu){ currentUser={role:"student",user:stu}; showStudentPage(stu); return; }
    }
    alert("Student not found!");
  }
  if(role==="teacher"){
    if(data.teachers.includes(id)){currentUser={role:"teacher",id};showTeacherPage();return;}
    alert("Teacher not found!");
  }
  if(role==="admin"){
    if(data.admins.includes(id)){currentUser={role:"admin",id};showAdminPage();return;}
    alert("Admin not found!");
  }
}

/* STUDENT FUNCTIONS */
function calculateAverage(grades){
  let scores=Object.values(grades).map(g=>g.score).filter(s=>!isNaN(s)&&s!==null);
  if(scores.length===0) return 0;
  return (scores.reduce((a,b)=>a+b,0)/scores.length).toFixed(2);
}
function getRemark(avg){
  avg=parseFloat(avg);
  if(avg>=80) return "Excellent";
  if(avg>=70) return "Very Good";
  if(avg>=60) return "Good";
  if(avg>=50) return "Pass";
  return "Fail";
}
function calculatePosition(stu){
  let classmates=data.students[stu.level];
  let averages=classmates.map(s=>({id:s.id,avg:parseFloat(calculateAverage(s.grades))||0}));
  averages.sort((a,b)=>b.avg-a.avg);
  return averages.findIndex(a=>a.id===stu.id)+1;
}
function showStudentPage(stu){
  document.getElementById("loginPage").classList.add("hidden");
  document.getElementById("studentPage").classList.remove("hidden");
  let avg=calculateAverage(stu.grades);
  let pos=calculatePosition(stu);
  let remark=getRemark(avg);
  let html=`<div class='report-card'><h2>CHARIS MODEL ACADEMY</h2><h3>Report Card</h3>
  <p><strong>Name:</strong> ${stu.name} | <strong>ID:</strong> ${stu.id} | <strong>Level:</strong> ${stu.level}</p>`;
  html+="<h4>Core Subjects</h4><table><tr><th>Subject</th><th>Score</th><th>Grade</th><th>Remark</th></tr>";
  subjects.core.forEach(sub=>{
    let g=stu.grades[sub];
    html+=`<tr><td>${sub}</td><td>${g.score??"-"}</td><td>${g.grade}</td><td>${g.remark}</td></tr>`;
  });
  html+="</table><h4>Electives</h4><table><tr><th>Subject</th><th>Score</th><th>Grade</th><th>Remark</th></tr>";
  subjects.elective.forEach(sub=>{
    let g=stu.grades[sub];
    html+=`<tr><td>${sub}</td><td>${g.score??"-"}</td><td>${g.grade}</td><td>${g.remark}</td></tr>`;
  });
  html+=`</table><div class="footer-info">Average: ${avg} | Position: ${pos}/${data.students[stu.level].length} | Remark: ${remark}</div>
  <div class="signatures"><div class="signature-block"><div class="signature-line"></div>Headmaster</div>
  <div class="signature-block"><div class="signature-line"></div>Class Teacher</div></div>
  <button class='print-btn' onclick='window.print()'>üñ®Ô∏è Print Report Card</button></div>`;
  document.getElementById("studentContent").innerHTML=html;
}

/* TEACHER FUNCTIONS */
function showTeacherPage(){
  document.getElementById("loginPage").classList.add("hidden");
  document.getElementById("teacherPage").classList.remove("hidden");
  let levelSel=document.getElementById("levelSelect");
  levelSel.innerHTML=levels.map(l=>`<option value='${l}'>${l}</option>`).join("");
  updateTeacherStudents();
  let subSel=document.getElementById("subjectSelect");
  subSel.innerHTML=allSubjects.map(s=>`<option value='${s}'>${s}</option>`).join("");
}
function updateTeacherStudents(){
  let lvl=document.getElementById("levelSelect").value;
  let sel=document.getElementById("studentSelect");
  sel.innerHTML=data.students[lvl].map(s=>`<option value='${s.id}'>${s.name} (${s.id})</option>`).join("");
}
document.getElementById("levelSelect").addEventListener("change",updateTeacherStudents);
function saveGrade(){
  let lvl=document.getElementById("levelSelect").value;
  let stuId=document.getElementById("studentSelect").value;
  let name=document.getElementById("nameInput").value.trim();
  let sub=document.getElementById("subjectSelect").value;
  let score=parseFloat(document.getElementById("scoreInput").value);
  if(isNaN(score)||score<0||score>100){alert("Invalid score");return;}
  let stu=data.students[lvl].find(s=>s.id===stuId);
  if(name) stu.name=name;
  let {grade,remark}=getGradeRemark(score);
  stu.grades[sub]={score,grade,remark};
  document.getElementById("teacherMsg").innerText=`Saved ${stu.name} - ${sub}: ${score} (${grade})`;
}

/* ADMIN FUNCTIONS */
function showAdminPage(){
  document.getElementById("loginPage").classList.add("hidden");
  document.getElementById("adminPage").classList.remove("hidden");
  updateTeacherList();
  let lvlSel=document.getElementById("adminLevelSelect");
  lvlSel.innerHTML=levels.map(l=>`<option value='${l}'>${l}</option>`).join("");
  updateAdminStudents();
  let subSel=document.getElementById("adminSubjectSelect");
  subSel.innerHTML=allSubjects.map(s=>`<option value='${s}'>${s}</option>`).join("");
}
function updateTeacherList(){
  let ul=document.getElementById("teacherList");
  ul.innerHTML=data.teachers.map(t=>`<li>${t}</li>`).join("");
}
function addTeacher(){
  let id=document.getElementById("newTeacherId").value.trim().toUpperCase();
  if(/^CMA-TE\d{3}$/.test(id)){if(!data.teachers.includes(id)){data.teachers.push(id);updateTeacherList();alert("Added");}else alert("Exists");}
  else alert("Invalid format");
}
function removeTeacher(){
  let id=document.getElementById("removeTeacherId").value.trim().toUpperCase();
  let i=data.teachers.indexOf(id);
  if(i>-1){data.teachers.splice(i,1);updateTeacherList();alert("Removed");}else alert("Not found");
}
function updateAdminStudents(){
  let lvl=document.getElementById("adminLevelSelect").value;
  let sel=document.getElementById("adminStudentSelect");
  sel.innerHTML=data.students[lvl].map(s=>`<option value='${s.id}'>${s.name} (${s.id})</option>`).join("");
}
document.getElementById("adminLevelSelect").addEventListener("change",updateAdminStudents);
function adminUpdateGrade(){
  let lvl=document.getElementById("adminLevelSelect").value;
  let stuId=document.getElementById("adminStudentSelect").value;
  let name=document.getElementById("adminNameInput").value.trim();
  let sub=document.getElementById("adminSubjectSelect").value;
  let score=parseFloat(document.getElementById("adminScoreInput").value);
  if(isNaN(score)||score<0||score>100){alert("Invalid score");return;}
  let stu=data.students[lvl].find(s=>s.id===stuId);
  if(name) stu.name=name;
  let {grade,remark}=getGradeRemark(score);
  stu.grades[sub]={score,grade,remark};
  document.getElementById("adminMsg").innerText=`Updated ${stu.name} - ${sub}: ${score} (${grade})`;
}

/* LOGOUT */
function logout(){
  currentUser=null;
  document.querySelectorAll(".container").forEach(c=>c.classList.add("hidden"));
  document.getElementById("loginPage").classList.remove("hidden");
  document.getElementById("idInput").value="";
  document.getElementById("nameInput").value="";
  document.getElementById("adminNameInput").value="";
  document.getElementById("teacherMsg").innerText="";
  document.getElementById("adminMsg").innerText="";
}
</script>
</body>
</html>
